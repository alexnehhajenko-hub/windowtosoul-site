<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Photo ‚Üí Artwork</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/assets/style.css" />
  </head>
  <body>
    <div class="app">
      <h1>üé® AI Photo ‚Üí Artwork</h1>
      <p class="subtitle">
        –°–µ–π—á–∞—Å –≤–µ—Ä—Å–∏—è –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ ‚Äî –º–æ–¥–µ–ª—å —Ä–∏—Å—É–µ—Ç –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é —Ç–µ–∫—Å—Ç–∞.
      </p>

      <form id="artForm">
        <label class="field-label">1. Choose style</label>
        <select id="style" class="field-input">
          <option value="oil painting">üñåÔ∏è Oil painting</option>
          <option value="classical art">üèõ Classical art</option>
          <option value="fantasy art">‚ú® Fantasy art</option>
          <option value="cinematic portrait">üé¨ Cinematic portrait</option>
        </select>

        <label class="field-label">2. Extra description (optional)</label>
        <input
          id="prompt"
          class="field-input"
          placeholder="For example: young woman in a yellow dress, sunset..."
        />

        <button type="submit" id="submitBtn">Generate Artwork</button>
      </form>

      <p id="status" class="status"></p>

      <h2>Your artwork</h2>
      <div class="result">
        <img id="resultImage" style="display: none; max-width: 100%" />
        <a
          id="downloadLink"
          href="#"
          download="artwork.png"
          style="display: none"
          >Download</a
        >
      </div>
    </div>

    <script>
      const form = document.getElementById("artForm");
      const statusEl = document.getElementById("status");
      const imgEl = document.getElementById("resultImage");
      const downloadEl = document.getElementById("downloadLink");
      const btn = document.getElementById("submitBtn");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const style = document.getElementById("style").value;
        const prompt = document.getElementById("prompt").value;

        statusEl.textContent = "‚è≥ Generating...";
        imgEl.style.display = "none";
        downloadEl.style.display = "none";
        btn.disabled = true;

        try {
          const res = await fetch("/api/generate", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ style, prompt }),
          });

          const data = await res.json();

          if (!res.ok) {
            throw new Error(
              data && data.error ? data.error : "Server error (" + res.status + ")"
            );
          }

          if (!data.imageUrl) {
            throw new Error("No imageUrl in response");
          }

          imgEl.src = data.imageUrl;
          imgEl.style.display = "block";

          downloadEl.href = data.imageUrl;
          downloadEl.style.display = "inline-block";

          statusEl.textContent = "";
        } catch (err) {
          console.error(err);
          statusEl.textContent = "‚ùå Error: " + err.message;
        } finally {
          btn.disabled = false;
        }
      });
    </script>
  </body>
</html>
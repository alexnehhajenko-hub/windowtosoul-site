<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Photo â†’ Artwork</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <h1>ğŸ¨ AI Photo â†’ Artwork</h1>

  <p>
    Upload your photo and get an AI-generated artwork.<br>
    <small>(Ğ•ÑĞ»Ğ¸ Ñ„Ğ¾Ñ‚Ğ¾ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ â€” AI Ñ€Ğ¸ÑÑƒĞµÑ‚ Ğ¿Ğ¾ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ.)</small>
  </p>

  <form id="artForm">
    <label>1. Upload photo (optional)</label><br>
    <input type="file" id="photo" accept="image/*"><br><br>

    <label>2. Choose style</label><br>
    <select id="style">
      <option value="oil painting">ğŸ–Œï¸ Oil painting</option>
      <option value="fantasy art">âœ¨ Fantasy art</option>
      <option value="realistic portrait">ğŸ“¸ Realistic portrait</option>
      <option value="classical art">ğŸ› Classical art</option>
      <option value="cinematic art">ğŸ¬ Cinematic</option>
    </select><br><br>

    <label>3. Extra description (optional)</label><br>
    <input id="prompt" placeholder="For example: warm sunset, mountains"><br><br>

    <button type="submit">Generate Artwork</button>
  </form>

  <p id="status"></p>

  <h2>Your artwork</h2>
  <img id="resultImage" style="max-width: 90%; display: none;" />
  <br>
  <a id="downloadLink" href="#" download="artwork.png" style="display: none;">Download</a>

  <script>
    async function fileToBase64(file) {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result.split(",")[1]);
        reader.readAsDataURL(file);
      });
    }

    const form = document.getElementById("artForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const status = document.getElementById("status");
      const resultImage = document.getElementById("resultImage");
      const downloadLink = document.getElementById("downloadLink");

      status.textContent = "â³ Generating...";
      resultImage.style.display = "none";
      downloadLink.style.display = "none";

      const fileInput = document.getElementById("photo");
      const style = document.getElementById("style").value;
      const promptText = document.getElementById("prompt").value;

      let base64 = null;
      if (fileInput.files.length > 0) {
        base64 = await fileToBase64(fileInput.files[0]);
      }

      const body = {
        imageBase64: base64,
        style: style,
        promptText: promptText
      };

      try {
        const res = await fetch("/api/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });

        const data = await res.json();

        if (!res.ok) throw new Error(data.error);

        resultImage.src = data.output;
        resultImage.style.display = "block";

        downloadLink.href = data.output;
        downloadLink.style.display = "inline-block";

        status.textContent = "";
      } catch (err) {
        status.textContent = "âŒ Error: " + err.message;
      }
    });
  </script>

</body>
</html>